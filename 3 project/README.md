# Формулировка: 

Передать любой файл из одного процесса в другой с использованием семафоров и разделяемой памяти. Процессы полностью независимы. Пар процессов может быть сколько угодно. Процессы не должны уходить в deadlock при смерти второй стороны. Файл должен быть передан полностью и не повреждён, не должно быть передано ничего лишнего. Использовать sleep, SIG_ALARM, etc - нельзя.

# Основная идея:

Разделяемая память едина, к ней с помощью семафоров подпускается только одна пара, которая в свою очередь также синхронизируется с помощью семафоров.

# Тонкости реализации:

1) На писателей и на читателей по семафору, с использованием SEM_UNDO - при выходе/смерти возможность зайти ещё одному возвращается.
2) Отсюда возникает проблема: нужно следить, чтобы не произшло подмены партнёра. (Как пример - вошёл читатель и писатель, не дошли до цикла чтения/записи. За время, пока планировщик не давал процессорного времени, например, читателю, его писатель умер - и успел зайти другой до того же места.) Это реализуется с помощью семафоров <суммарного коннекта> - они должны быть вполне определённых значений при корректной работе.
3) Вообще говоря, существует проблема переполнения семафоров суммарного коннекта, поэтому периодически в программе они уменьшаются.
4) Запись/чтение с памяти контролируется с помощью семафоров FULL/EMPTY, на них не висит SEM_UNDO, так как они каждый раз переинициализируются в писателе (при создании новой пары).
5) Коннект двух процессов также отслеживается - если, например, было создано всего по одному читателю и писателю, то при сметри одного второй это заметит и тоже *завершится*.